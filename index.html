<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

		<title>Domotic</title>

		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/ami.min.js"></script>

		<script type="text/javascript">

			amiWebApp.onRefresh = function(isAuth)
			{
				/*---------------------------------------------------------*/

				var main_menu =
					'<li class="nav-item dropdown">' +
					'	<a href="' + amiWebApp.webAppURL + '" class="nav-link">' +
					'		Dashboard' +
					'	</a>' +
					'<li class="nav-item dropdown">' +
					'	<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">' +
					'		Devices' +
					'	</a>' +
					'	<div class="dropdown-menu">' +
					'	</div>' +
					'</li>'
				;

				if(amiLogin.hasRole('AMI_ADMIN'))
				{
					main_menu +=
						'<li class="nav-item dropdown">' +
						'	<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">' +
						'		<i class="fa fa-key"></i> Admin' +
						'	</a>' +
						'	<div class="dropdown-menu">' +
						'		<a class="dropdown-item" href="' + amiWebApp.webAppURL + '?subapp=command">Command</a>' +
						'		<a class="dropdown-item" href="' + amiWebApp.webAppURL + '?subapp=emergency">Emergency</a>' +
						'		<div class="dropdown-divider"></div>' +
						'		<a class="dropdown-item" href="' + amiWebApp.webAppURL + '?subapp=adminDashboard">Admin Dashboard</a>' +
						'		<div class="dropdown-divider"></div>' +
						'		<a class="dropdown-item" href="' + amiWebApp.webAppURL + '?subapp=document&userdata=api.html">Web Framework API</a>' +
						'		<a class="dropdown-item" href="' + amiWebApp.webAppURL + '?subapp=document&userdata=info.html">Web Framework Info</a>' +
						'	</div>' +
						'</li>'
					;
				}

				$('#ami_main_menu_content').html(main_menu);

				/*---------------------------------------------------------*/
			};

			amiWebApp.onReady = function()
			{
				return amiWebApp.loadSubAppByURL('userDashboard');
			};

		</script>
	</head>
	<body>

		<script type="text/javascript">

			var subapp = new URL(window.location.href).searchParams.get('subapp');

			var theme_url = !subapp || subapp.toLowerCase() === 'userdashboard' ? 'twig/AMI/Theme/cloud.twig'
				                                                                : 'twig/AMI/Theme/white.twig'
			;

			amiWebApp.start({
				logo_url: 'images/logo.png',
				theme_url: theme_url,
				contact_email: 'odier.jerome@gmail.com',
				endpoint_url: 'https://localhost:8443/AMI/FrontEnd',
			});

		</script>

	</body>
</html>
